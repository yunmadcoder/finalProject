<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/project/css/approval/approval-form.css">
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/project/css/source/dropzone.min.css">

<div class="card rounded-0 flex-fill">
	<div class="m-3 ms-4">
		<h3 class="m-0">업무 기안</h3>
	</div>
	<div class="d-flex justify-content-start align-items-center border-bottom">
		<div class="ms-4 py-3">
			<a href="#" class="ms-3 fa-active">
				<i class="fa-light fa-pen-to-square fa-xl fa-fw fa"></i>
				<span>결재요청</span>
			</a>
			<a href="#" class="ms-3 fa-active">
				<i class="fa-light fa-arrow-down-to-square fa-xl fa-fw fa"></i>
				<span>임시저장</span>
			</a>
			<a href="#" class="ms-3 fa-active">
				<i class="fa-light fa-eye fa-xl fa-fw fa"></i>
				<span>미리보기</span>
			</a>
			<a href="#" class="ms-3 fa-active">
				<i class="fa-light fa-circle-xmark fa-xl fa-fw fa"></i>
				<span>취소</span>
			</a>
		</div>
		<a href="#" class="ms-auto me-4 fa-active" id="main">
			<i class="fa-light fa-bars fa-xl fa-fw fa"></i>
			<span>목록</span>
		</a>
	</div>
	<div class="card-body rounded-0 p-0">
		<div class="row">
			<div class="col-lg-10">
				<div class="mx-5 my-4 p-3 border border-4" style="border-color: #999;">
					<div class="approval_import ie9-scroll-fix">
						<!-- 문서 내용 표시 테스트 -->
						<form id="document_content" class="form_doc_editor editor_view" onsubmit="return false;">
							<span style="font-family: &amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; 맑은 고딕&amp;amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot;; font-size: 10pt;">
								<p style="text-align: right; font-family: &amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; 맑은 고딕&amp;amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot;; font-size: 10pt; line-height: 150%; margin-top: 0px; margin-bottom: 0px;">
									<span style="font-family: &amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; 맑은 고딕&amp;amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot;; font-size: 10pt;"> </span>
									&nbsp;
								</p>
								<table style="border: 0px solid rgb(0, 0, 0); border-image: none; width: 800px; font-family: malgun gothic, dotum, arial, tahoma; margin-top: 1px; border-collapse: collapse;">
									<!-- Header -->
									<colgroup>
										<col width="310">
										<col width="490">
									</colgroup>

									<tbody>
										<tr>
											<td style="background: white; padding: 0px !important; border: 0px currentColor; border-image: none; height: 90px; text-align: center; color: black; font-size: 36px; font-weight: bold; vertical-align: middle;" colspan="2" class="">업 무 기 안</td>
										</tr>
										<tr>
											<td style="background: white; padding: 0px !important; border: currentColor; border-image: none; text-align: left; color: black; font-size: 12px; font-weight: normal; vertical-align: top;">
												<span class="sign_type1_inline" data-group-seq="3" data-group-name="합의" data-group-max-count="1" data-group-type="type1" data-is-agreement="true" id="agreementWrap"></span>
												<!-- 에디터 &nbsp; 버그. 개행과 공백을 최소화 시키자. -->
												<table style="border: 1px solid rgb(0, 0, 0); border-image: none; font-family: malgun gothic, dotum, arial, tahoma; margin-top: 1px; border-collapse: collapse;">
													<!-- User -->
													<colgroup>
														<col width="90">
														<col width="220">
													</colgroup>

													<tbody>
														<tr>
															<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 18px; text-align: center; color: rgb(0, 0, 0); font-size: 12px; font-weight: bold; vertical-align: middle;">기안자</td>
															<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 12px; font-weight: normal; vertical-align: middle;">
																<input type="text" readonly="" style="vertical-align: middle; width: 100%; border: 0px; box-shadow: inset 0px 0px 0px rgba(150, 150, 150, 0.2)" data-dsl="{{label:draftUser}}" name="draftUser" id="draftUser" value="김상후" data-id="draftUser" data-name="draftUser" data-require="false" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="김상후" placeholder="">
															</td>
														</tr>
														<tr>
															<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 18px; text-align: center; color: rgb(0, 0, 0); font-size: 12px; font-weight: bold; vertical-align: middle;">소속</td>
															<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 12px; font-weight: normal; vertical-align: middle;">
																<input type="text" readonly="" style="vertical-align: middle; width: 100%; border: 0px; box-shadow: inset 0px 0px 0px rgba(150, 150, 150, 0.2)" data-dsl="{{label:draftDept}}" name="draftDept" id="draftDept" value="다우그룹" data-id="draftDept" data-name="draftDept" data-require="false" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="다우그룹" placeholder="">
															</td>
														</tr>
														<tr>
															<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 18px; text-align: center; color: rgb(0, 0, 0); font-size: 12px; font-weight: bold; vertical-align: middle;">기안일</td>
															<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 12px; font-weight: normal; vertical-align: middle;">
																<input type="text" readonly="" style="vertical-align: middle; width: 100%; border: 0px; box-shadow: inset 0px 0px 0px rgba(150, 150, 150, 0.2)" data-dsl="{{label:draftDate}}" name="draftDate" id="draftDate" value="" data-id="draftDate" data-name="draftDate" data-require="false" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="2024-04-17(수)" placeholder="">
															</td>
														</tr>
														<tr>
															<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 18px; text-align: center; color: rgb(0, 0, 0); font-size: 12px; font-weight: bold; vertical-align: middle;">문서번호</td>
															<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 12px; font-weight: normal; vertical-align: middle;">
																<input type="text" readonly="" style="vertical-align: middle; width: 100%; border: 0px; box-shadow: inset 0px 0px 0px rgba(150, 150, 150, 0.2)" data-dsl="{{label:docNo}}" name="docNo" id="docNo" value="" data-id="docNo" data-name="docNo" data-require="false" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="" placeholder="">
															</td>
														</tr>
													</tbody>
												</table>

											</td>
											<td style="background: white; padding: 0px !important; border: currentColor; border-image: none; text-align: right; color: black; font-size: 12px; font-weight: normal; vertical-align: top;">
												<span class="sign_type1_inline" data-group-seq="0" data-group-name="신청" data-group-max-count="1" data-group-type="type1" data-is-reception="">
													<span class="sign_tit_wrap">
														<span class="sign_tit">
															<strong>신청</strong>
														</span>
													</span>
													<span class="sign_member_wrap" id="activity_15747">
														<span class="sign_member">
															<span class="sign_rank_wrap">
																<span class="sign_rank">대표이사</span>
															</span>
															<span class="sign_wrap">
																<span class="sign_name">김상후</span>
															</span>
															<span class="sign_date_wrap">
																<span class="sign_date " id="date_15747"></span>
															</span>
														</span>
													</span>
												</span>
												<!-- 에디터 &nbsp; 버그. 개행과 공백을 최소화 시키자. -->
												<span class="sign_type1_inline" data-group-seq="1" data-group-name="승인" data-group-max-count="10" data-group-type="type1" data-is-reception="">
													<span class="sign_tit_wrap">
														<span class="sign_tit">
															<strong>승인</strong>
														</span>
													</span>
													<span class="sign_member_wrap" id="activity_15748">
														<span class="sign_member">
															<span class="sign_rank_wrap">
																<span class="sign_rank">차장</span>
															</span>
															<span class="sign_wrap">
																<span class="sign_name">전병헌</span>
															</span>
															<span class="sign_date_wrap">
																<span class="sign_date " id="date_15748"></span>
															</span>
														</span>
													</span>
												</span>
												<!-- 에디터 &nbsp; 버그. 개행과 공백을 최소화 시키자. -->
												<span class="sign_type1_inline" data-group-seq="2" data-group-name="수신" data-group-max-count="7" data-group-type="type1" data-is-reception=""></span>
												<!-- 에디터 &nbsp; 버그. 개행과 공백을 최소화 시키자. -->
											</td>
										</tr>
									</tbody>
								</table>
								<br>


								<table style="border: 0px solid rgb(0, 0, 0); border-image: none; width: 800px; font-family: malgun gothic, dotum, arial, tahoma; margin-top: 10px; border-collapse: collapse;">
									<!-- Draft -->
									<colgroup>
										<col width="120">
										<col width="230">
										<col width="120">
										<col width="330">
									</colgroup>

									<tbody>
										<tr>
											<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 25px; text-align: center; color: rgb(0, 0, 0); font-size: 14px; font-weight: bold; vertical-align: middle;">시행일자</td>
											<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal; vertical-align: middle;">
												<input type="text" readonly="" class="ipt_editor ipt_editor_date hasDatepicker" data-dsl="{{calendar$width:150$}}" id="editorForm_4" data-id="" data-name="" data-require="false" data-maxlength="" data-width="150" data-defaultstr="" data-editable="false" name="editorForm_4" data-value="" placeholder="" value="" style="width: 150px;">
											</td>
											<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; text-align: center; color: rgb(0, 0, 0); font-size: 14px; font-weight: bold; vertical-align: middle;">협조부서</td>
											<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal; vertical-align: middle;">
												<input type="text" class="ipt_editor" data-dsl="{{text$defaultstr:111$}}" name="editorForm_5" id="editorForm_5" value="" data-id="" data-name="" data-require="false" data-maxlength="" data-width="" data-defaultstr="111" data-editable="false" data-value="" placeholder="">
											</td>
										</tr>
										<tr>
											<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 25px; text-align: center; color: rgb(0, 0, 0); font-size: 14px; font-weight: bold; vertical-align: middle;">합의</td>
											<td style="background: rgb(255, 255, 255); border-width: medium 1px 1px; border-style: none solid solid; border-color: currentColor black black; padding: 5px; text-align: left; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal; vertical-align: middle;" colspan="3" class="">
												<span class="sign_type2" id="agreementWrap">
													<span class="sign_member">
														<span class="part" style="font-family: &amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; malgun gothic&amp;amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; , dotum , arial, tahoma; font-size: 11pt;">|</span>
														<span class="name" style="font-family: &amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; malgun gothic&amp;amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; amp; quot; , dotum , arial, tahoma; font-size: 11pt;"> </span>
													</span>
												</span>
											</td>
										</tr>
										<tr>
											<td style="background: rgb(221, 221, 221); padding: 5px; border: 1px solid black; border-image: none; height: 25px; text-align: center; color: rgb(0, 0, 0); font-size: 14px; font-weight: bold; vertical-align: middle;">제목</td>
											<td style="background: rgb(255, 255, 255); padding: 5px; border: 1px solid black; border-image: none; text-align: left; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal; vertical-align: middle;" colspan="3">
												<input type="text" class="ipt_editor" data-dsl="{{text$require$:subject}}" name="subject" id="subject" value="" data-id="subject" data-name="subject" data-require="true" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="" placeholder="필수값 입니다.">
											</td>
										</tr>
										<tr>
											<td style="background: rgb(255, 255, 255); border-width: medium 1px 1px; border-style: none solid solid; border-color: currentColor black black; padding: 5px; height: 350px; text-align: left; color: rgb(0, 0, 0); font-size: 14px; font-weight: normal; vertical-align: top;" colspan="4" class="">
												<span data-dsl="{{editor:appContent}}" name="appContent" id="appContent" style="width: 100%; min-width: 200px;" data-id="appContent" data-name="appContent" data-require="false" data-maxlength="" data-width="" data-defaultstr="" data-editable="false" data-value="" placeholder="" value="" data-skintype="detail" class="go-editor">
													<textarea name="" id="" rows="20" style="width: 100%; min-width: 200px;"></textarea>
												</span>
											</td>
										</tr>
									</tbody>
								</table>
							</span>
						</form>
					</div>
					<table class="table table-borderless mt-3">
						<tr>
							<th width=20% class="text-center align-middle">파일 첨부</th>
							<td width=80%>
								<div class="dropzone"></div>
								<!-- 포스팅 - 이미지/동영상 dropzone 영역 -->
								<ul class="list-unstyled mb-0" id="dropzone-preview">
									<li class="mt-2" id="dropzone-preview-list">
										<div class="border rounded-3">
											<div class="d-flex align-items-center p-2">
												<div class="flex-shrink-0 me-3">
													<div class="width-8 h-auto rounded-3">
														<img data-dz-thumbnail="data-dz-thumbnail" class="w-full h-auto rounded-3 block" src="#" alt="Dropzone-Image" style="width: 120px;" />
													</div>
												</div>
												<div class="flex-grow-1">
													<div class="pt-1">
														<h6 class="font-semibold mb-1" data-dz-name="data-dz-name">&nbsp;</h6>
														<p class="text-sm text-muted fw-normal" data-dz-size="data-dz-size"></p>
														<strong class="error text-danger" data-dz-errormessage="data-dz-errormessage"></strong>
													</div>
												</div>
												<div class="shrink-0 ms-3">
													<a href="#" data-dz-remove="data-dz-remove" class="fa-active">
														<iconify-icon icon="f7:xmark-square" width="2rem" height="2rem"></iconify-icon>
													</a>
												</div>
											</div>
										</div>
									</li>
								</ul>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<div class="col-lg-2 ps-0 aside border-start">
				<div class="header">
					<div class="text-center border-bottom border-start px-1 py-2">
						<span class="font-weight-bold">결재선</span>
					</div>
					<div>
						<ul>
							<li class="py-2 px-3 position-relative current">
								<span class="photo d-inline-block position-absolute">
									<a href="#">
										<img alt="" src="${pageContext.request.contextPath }/resources/vendor/images/profile/user-1.jpg" class="rounded-circle img-fluid w-100 h-100">
									</a>
								</span>
								<div class="wrap position-relative ms-4">
									<div class="info ms-4">
										<a href="#">
											<span class="name d-inline-block text-black font-weight-bold">이명문 상무</span>
										</a>
										<span class="dept d-block overflow-hidden text-truncate text-nowrap">어떠한부서</span>
										<div class="doc">
											<span class="status d-inline-block">기안</span>
										</div>
									</div>
								</div>
								<div class="current-bar position-absolute top-0 start-0 h-100"></div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="${pageContext.request.contextPath }/resources/project/js/source/dropzone.min.js"></script>
<script>
	Dropzone.autoDiscover = false;

	$(function() {
		$('#main').on('click', function(e) {
			e.preventDefault();
			location.href = '/approval';
		});
		var dropzonePreviewNode = document
				.querySelector('#dropzone-preview-list');
		dropzonePreviewNode.id = '';
		var previewTemplate = dropzonePreviewNode.parentNode.innerHTML;
		dropzonePreviewNode.parentNode.removeChild(dropzonePreviewNode);

		console.log(header);
		console.log(token);

		const dropzone = new Dropzone('.dropzone', {
			url : '/approval/insert',
			method : 'post',
			headers : {
				header : token
			},

			previewTemplate : previewTemplate,
			previewsContainer : '#dropzone-preview',

			autoProcessQueue : false,
			clickable : true,
			autoQueue : false,
			createImageThumbnails : true,

			thumbnailHeight : 120,
			thumbnailWidth : 120,

			paramName : 'files',
			uploadMultiple : true,

			maxFilesize : 100,
			maxFiles : 5,

			dictDefaultMessage : '이 곳에 파일을 드래그 하세요. 또는 파일 선택',
			dictMaxFilesExceeded : '최대 파일 수를 초과했습니다',
			dictFileTooBig : '파일 최대 크기 범위를 초과했습니다',

			init : function() {

				let drop = this;

				if (drop.getRejectedFiles().length > 0) {
					let files = dropzone.getRejectedFiles();
					console.log('거부된 파일이 있습니다.', files);
					return;
				}

				drop.processQueue();
			}
		});
	});
</script>
